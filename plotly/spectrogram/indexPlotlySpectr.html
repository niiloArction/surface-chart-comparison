<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body>

    <div id="tester" style="width:100%;height:100%;"></div>

    <script src="plotly-2.4.2.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
    <script src="xydata.iife.js"></script>
    <script>

        const CONFIG = {
            columns: 50,
            rows: 60,
        }

        const { rows, columns } = CONFIG

        const {
            createSpectrumDataGenerator
        } = xydata

        var data = [{
            z: [],
            type: 'surface'
        }];

        var layout = {
            scene:{
                aspectmode: "manual",
                yaxis: {
                    range: [0, 60],
                }},
        };
        Plotly.newPlot('tester', data, layout);


        createSpectrumDataGenerator()
            .setSampleSize( columns )
            .setNumberOfSamples( rows )
            .generate()
            .toPromise()
            .then(dataSetsList => {

                let iDataSet = 0

                const changeDataSet = () => {

                    data[0]['z'].push(dataSetsList[iDataSet])

                    if(data[0]['z'].length > 60){
                        data[0]['z'].shift()
                    }

                    iDataSet = (iDataSet + 1) % rows
                    
                    Plotly.redraw('tester')
                    
                }

                setInterval(changeDataSet, 100)

                
            })
        
    </script>
</body>
</html>
